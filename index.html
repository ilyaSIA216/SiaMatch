<!DOCTYPE html>
<html lang="ru" data-color-mode="auto" data-light-theme="light" data-dark-theme="dark">
<head>
  <meta charset="utf-8" />
  <title>SiaMatch - Dating</title>

  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
  />

  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    :root {
      --tg-theme-bg-color: #f4fff7;
      --tg-theme-text-color: #063b1f;
      --siamatch-green: #16a34a;
      --siamatch-green-dark: #15803d;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: radial-gradient(circle at top, #d9f99d 0, #f4fff7 45%, #ecfdf3 100%);
      color: var(--tg-theme-text-color);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    .logo {
      font-size: 40px;
      margin-bottom: 8px;
    }

    .app-name {
      font-size: 18px;
      font-weight: 600;
      color: var(--siamatch-green-dark);
      margin-bottom: 4px;
    }

    h1 {
      font-size: 24px;
      margin: 4px 0 8px;
    }

    #username {
      font-size: 16px;
      margin-bottom: 18px;
    }

    #card {
      width: 100%;
      max-width: 420px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 20px 18px 24px;
      box-shadow: 0 10px 25px rgba(22, 163, 74, 0.18);
      backdrop-filter: blur(8px);
    }

    #profile-form {
      display: none;
      width: 100%;
      text-align: left;
      margin-top: 10px;
    }

    #profile-form h2 {
      font-size: 20px;
      margin-bottom: 10px;
      text-align: center;
      color: var(--siamatch-green-dark);
    }

    label {
      display: block;
      font-size: 14px;
      margin-bottom: 4px;
    }

    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 9px 10px;
      font-size: 14px;
      border-radius: 10px;
      border: 1px solid #bbf7d0;
      outline: none;
      background-color: #f0fdf4;
    }

    input[type="number"]:focus,
    select:focus,
    textarea:focus {
      border-color: var(--siamatch-green);
      box-shadow: 0 0 0 1px rgba(22, 163, 74, 0.35);
    }

    textarea {
      resize: none;
    }

    .field {
      margin-bottom: 12px;
    }

    .hint {
      font-size: 12px;
      opacity: 0.7;
      margin-top: 2px;
    }

    #mainButton {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      color: #ffffff;
      border: none;
      padding: 13px 32px;
      font-size: 17px;
      border-radius: 999px;
      cursor: pointer;
      user-select: none;
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.2s ease;
      margin-top: 18px;
      width: 100%;
      max-width: 260px;
    }

    #mainButton:active {
      transform: translateY(1px);
      box-shadow: 0 4px 10px rgba(22, 163, 74, 0.35);
      background: linear-gradient(135deg, #16a34a, #15803d);
    }
  </style>
</head>
<body>
  <div id="card">
    <div class="logo">üçÄ</div>
    <div class="app-name">SiaMatch</div>

    <h1>Welcome to SiaMatch</h1>
    <div id="username">Loading user info...</div>

    <div id="profile-form">
      <h2>–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å üçÄ</h2>

      <div class="field">
        <label for="age">–í–æ–∑—Ä–∞—Å—Ç</label>
        <input type="number" id="age" min="18" max="99" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 25" required />
        <div class="hint">–¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ 18+</div>
      </div>

      <div class="field">
        <label for="gender">–ü–æ–ª</label>
        <select id="gender">
          <option value="male">–ú—É–∂—Å–∫–æ–π</option>
          <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
          <option value="other">–î—Ä—É–≥–æ–µ</option>
        </select>
      </div>

      <div class="field">
        <label for="bio">–û —Å–µ–±–µ</label>
        <textarea
          id="bio"
          rows="3"
          maxlength="300"
          placeholder="–ö–æ—Ä–æ—Ç–∫–æ –æ —Å–µ–±–µ –∏ –∫–æ–≥–æ —Ö–æ—Ç–∏—Ç–µ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å üçÄ"
        ></textarea>
        <div class="hint">–ú–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤, –º–∞–∫—Å–∏–º—É–º 300</div>
      </div>
    </div>

    <button id="mainButton">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å üçÄ</button>
  </div>

  <script>
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();

    const theme = Telegram.WebApp.themeParams || {};
    if (theme.bg_color) {
      document.documentElement.style.setProperty("--tg-theme-bg-color", theme.bg_color);
    }
    if (theme.text_color) {
      document.documentElement.style.setProperty("--tg-theme-text-color", theme.text_color);
    }

    const user = Telegram.WebApp.initDataUnsafe
      ? Telegram.WebApp.initDataUnsafe.user
      : null;

    const usernameElem = document.getElementById("username");
    const profileForm = document.getElementById("profile-form");
    const mainBtn = document.getElementById("mainButton");

    if (user) {
      const name = user.first_name || user.username || "–¥—Ä—É–≥";
      usernameElem.textContent = `–ü—Ä–∏–≤–µ—Ç, ${name}!`;
    } else {
      usernameElem.textContent = "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞.";
    }

    mainBtn.onclick = () => {
      profileForm.style.display = "block";
      mainBtn.textContent = "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å üçÄ";
      mainBtn.onclick = saveProfile;
    };

    function saveProfile() {
      const ageValue = Number(document.getElementById("age").value);
      const gender = document.getElementById("gender").value;
      const bio = document.getElementById("bio").value.trim();

      if (!ageValue || ageValue < 18 || ageValue > 99) {
        alert("–£–∫–∞–∂–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç –æ—Ç 18 –¥–æ 99 –ª–µ—Ç");
        return;
      }

      if (bio.length < 10) {
        alert("–ù–∞–ø–∏—à–∏—Ç–µ –æ —Å–µ–±–µ —Ö–æ—Ç—è –±—ã 10 —Å–∏–º–≤–æ–ª–æ–≤");
        return;
      }

      const profileData = {
        tg_id: user ? user.id : null,
        first_name: user ? user.first_name : null,
        username: user ? user.username : null,
        age: ageValue,
        gender,
        bio
      };

      console.log("Profile data:", profileData);
      alert("–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω! –í —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ –¥–æ–±–∞–≤–∏–º –ø–æ–∏—Å–∫ –∏ –º—ç—Ç—á–∏ üçÄ");
    }
  </script>
</body>
</html>
