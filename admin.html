<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>SiaMatch Admin</title>
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
  />
  <style>
    :root {
      --bg: #020617;
      --card-bg: #0f172a;
      --accent: #22c55e;
      --accent-dark: #16a34a;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --danger: #ef4444;
      --warning: #f59e0b;
      --info: #3b82f6;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: radial-gradient(circle at top, #0f172a 0, #020617 60%, #000 100%);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }
    #admin-root {
      width: 100%;
      max-width: 800px;
    }
    .card {
      background: rgba(15, 23, 42, 0.96);
      border-radius: 18px;
      padding: 20px 18px 22px;
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.2);
    }
    .logo {
      font-size: 32px;
      text-align: center;
      margin-bottom: 4px;
    }
    .title {
      text-align: center;
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .subtitle {
      text-align: center;
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 18px;
    }
    .field {
      margin-bottom: 14px;
    }
    label {
      display: block;
      font-size: 13px;
      margin-bottom: 4px;
      color: var(--muted);
    }
    input[type="password"],
    input[type="text"] {
      width: 100%;
      padding: 9px 10px;
      border-radius: 10px;
      border: 1px solid #1f2937;
      background: #020617;
      color: var(--text);
      font-size: 14px;
      outline: none;
    }
    input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.5);
    }

    /* –ö–Ω–æ–ø–∫–∏ */
    .primary {
      border: none;
      padding: 10px 16px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: white;
      font-size: 15px;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.08s ease;
    }
    .primary:active {
      transform: translateY(1px);
      box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
    }
    #login-btn {
      width: 100%;
      margin-top: 6px;
    }

    .error {
      margin-top: 6px;
      font-size: 12px;
      color: var(--danger);
      min-height: 16px;
    }
    .hint {
      font-size: 12px;
      color: var(--muted);
      margin-top: 4px;
    }
    .hidden {
      display: none;
    }

    /* –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å */
    #admin-panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 18px;
      gap: 8px;
    }
    #admin-panel-header .left {
      display: flex;
      flex-direction: column;
    }
    #admin-panel-header h2 {
      font-size: 18px;
      margin: 0 0 2px;
    }
    #admin-panel-header span {
      font-size: 12px;
      color: var(--muted);
    }
    #logout-btn {
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: transparent;
      color: var(--muted);
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
    }

    /* –¢–∞–±—ã */
    #admin-tabs {
      display: flex;
      gap: 6px;
      margin-bottom: 18px;
      flex-wrap: wrap;
    }
    .tab-btn {
      border: none;
      background: rgba(148, 163, 184, 0.1);
      color: var(--muted);
      border-radius: 10px;
      padding: 8px 14px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease;
      flex: 1;
      min-width: 120px;
      text-align: center;
    }
    .tab-btn:hover {
      background: rgba(148, 163, 184, 0.2);
    }
    .tab-btn.active {
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: white;
      font-weight: 500;
    }

    /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 12px;
      margin-bottom: 20px;
    }
    .stat-card {
      background: rgba(2, 6, 23, 0.7);
      border-radius: 12px;
      padding: 14px;
      border: 1px solid rgba(148, 163, 184, 0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }
    .stat-number {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .stat-number.total { color: var(--accent); }
    .stat-number.new { color: var(--info); }
    .stat-number.active { color: #10b981; }
    .stat-number.blocked { color: var(--danger); }
    .stat-label {
      font-size: 12px;
      color: var(--muted);
    }

    /* –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ (—Ç–æ–ª—å–∫–æ –≤ –ø–æ–∏—Å–∫–µ) */
    #search-row {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
      align-items: center;
      display: none;
    }
    #search-row.active {
      display: flex;
    }
    #search-input {
      flex: 1;
    }
    #search-btn {
      width: auto;
      padding: 8px 16px;
      font-size: 14px;
      white-space: nowrap;
    }

    /* –§–∏–ª—å—Ç—Ä—ã (—Ç–æ–ª—å–∫–æ –≤ –ø–æ–∏—Å–∫–µ) */
    #filters-row {
      display: none;
      gap: 8px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }
    #filters-row.active {
      display: flex;
    }
    .filter-select {
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid #1f2937;
      background: #020617;
      color: var(--text);
      font-size: 13px;
      min-width: 120px;
    }

    /* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */
    #results-info {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 12px;
      padding: 8px 0;
      border-bottom: 1px solid rgba(148, 163, 184, 0.1);
    }
    #users-list {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: 400px;
      overflow-y: auto;
    }
    .user-item {
      border-radius: 10px;
      padding: 12px 14px;
      border: 1px solid #1f2937;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      background: #020617;
      font-size: 13px;
    }
    .user-item.blocked {
      border-left: 4px solid var(--danger);
      opacity: 0.8;
    }
    .user-item.new {
      border-left: 4px solid var(--info);
    }
    .user-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .user-name {
      font-weight: 500;
    }
    .user-meta {
      color: var(--muted);
      font-size: 12px;
      display: flex;
      gap: 12px;
    }
    .user-actions {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
    }
    .link-btn {
      border: none;
      background: none;
      color: var(--accent);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .block-btn {
      border: none;
      background: none;
      color: var(--danger);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }
    .unblock-btn {
      border: none;
      background: none;
      color: var(--warning);
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      text-align: right;
    }

    /* –ë–∞–Ω–Ω–µ—Ä—ã —Ä–∞–∑–¥–µ–ª–æ–≤ */
    .section-banner {
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 20px;
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(16, 185, 129, 0.05));
      border: 1px solid rgba(34, 197, 94, 0.2);
    }
    .section-banner.search {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.05));
      border-color: rgba(59, 130, 246, 0.2);
    }
    .section-banner.blocked {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.05));
      border-color: rgba(239, 68, 68, 0.2);
    }
    .section-banner h3 {
      margin: 0 0 6px;
      font-size: 16px;
    }
    .section-banner p {
      margin: 0;
      font-size: 13px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <div id="admin-root">
    <!-- –≠–∫—Ä–∞–Ω –ª–æ–≥–∏–Ω–∞ -->
    <div id="login-card" class="card">
      <div class="logo">üçÄ</div>
      <div class="title">SiaMatch Admin</div>
      <div class="subtitle">–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</div>

      <div class="field">
        <label for="password">–ü–∞—Ä–æ–ª—å</label>
        <input type="password" id="password" autocomplete="off" />
        <div class="hint">–í–≤–µ–¥–∏—Ç–µ –∞–¥–º–∏–Ω‚Äë–ø–∞—Ä–æ–ª—å, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.</div>
      </div>

      <button id="login-btn" class="primary">–í–æ–π—Ç–∏</button>
      <div id="login-error" class="error"></div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –∞–¥–º–∏–Ω‚Äë–ø–∞–Ω–µ–ª–∏ -->
    <div id="admin-card" class="card hidden">
      <div id="admin-panel-header">
        <div class="left">
          <h2>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
          <span>–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</span>
        </div>
        <button id="logout-btn">–í—ã–π—Ç–∏</button>
      </div>

      <!-- –¢–∞–±—ã -->
      <div id="admin-tabs">
        <button class="tab-btn active" data-tab="all">–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>
        <button class="tab-btn" data-tab="new">–ù–æ–≤—ã–µ</button>
        <button class="tab-btn" data-tab="blocked">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</button>
        <button class="tab-btn" data-tab="search">–ü–æ–∏—Å–∫</button>
      </div>

      <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
      <div id="stats-section" class="stats-grid">
        <div class="stat-card">
          <span class="stat-number total" id="stat-total">0</span>
          <span class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</span>
        </div>
        <div class="stat-card">
          <span class="stat-number new" id="stat-new">0</span>
          <span class="stat-label">–ù–æ–≤—ã—Ö –∑–∞ 24—á</span>
        </div>
        <div class="stat-card">
          <span class="stat-number active" id="stat-active">0</span>
          <span class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö</span>
        </div>
        <div class="stat-card">
          <span class="stat-number blocked" id="stat-blocked">0</span>
          <span class="stat-label">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</span>
        </div>
      </div>

      <!-- –ë–∞–Ω–Ω–µ—Ä—ã —Ä–∞–∑–¥–µ–ª–æ–≤ -->
      <div id="section-banner-all" class="section-banner">
        <h3>–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
        <p>–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ú–æ–∂–Ω–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å, —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –º–æ–¥–µ—Ä–∞—Ü–∏—é.</p>
      </div>

      <div id="section-banner-new" class="section-banner hidden">
        <h3>–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
        <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–≤—à–∏–µ—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞. –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
      </div>

      <div id="section-banner-blocked" class="section-banner blocked hidden">
        <h3>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
        <p>–ê–Ω–∫–µ—Ç—ã, –≤—Ä–µ–º–µ–Ω–Ω–æ –∏–ª–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –æ—Ç –ø–æ–∫–∞–∑–∞ –≤ –ª–µ–Ω—Ç–µ.</p>
      </div>

      <div id="section-banner-search" class="section-banner search hidden">
        <h3>–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫</h3>
        <p>–ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –ø–æ–ª—è–º –∞–Ω–∫–µ—Ç—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è —Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.</p>
      </div>

      <!-- –ü–æ–∏—Å–∫–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–ü–æ–∏—Å–∫") -->
      <div id="search-row">
        <input
          type="text"
          id="search-input"
          placeholder="–ü–æ–∏—Å–∫ –ø–æ ID, –∏–º–µ–Ω–∏, username, –≥–æ—Ä–æ–¥—É..."
        />
        <button id="search-btn" class="primary">–ù–∞–π—Ç–∏</button>
      </div>

      <!-- –§–∏–ª—å—Ç—Ä—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ "–ü–æ–∏—Å–∫") -->
      <div id="filters-row">
        <select id="filter-gender" class="filter-select">
          <option value="">–í—Å–µ –ø–æ–ª—ã</option>
          <option value="male">–ú—É–∂—Å–∫–æ–π</option>
          <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
        </select>
        <select id="filter-city" class="filter-select">
          <option value="">–í—Å–µ –≥–æ—Ä–æ–¥–∞</option>
          <option value="–ú–æ—Å–∫–≤–∞">–ú–æ—Å–∫–≤–∞</option>
          <option value="–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
          <option value="–ö–∞–∑–∞–Ω—å">–ö–∞–∑–∞–Ω—å</option>
        </select>
        <input type="number" id="filter-age-min" class="filter-select" placeholder="–í–æ–∑—Ä–∞—Å—Ç –æ—Ç" min="18" max="99">
        <input type="number" id="filter-age-max" class="filter-select" placeholder="–¥–æ" min="18" max="99">
      </div>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
      <div id="results-info">–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...</div>
      <ul id="users-list"></ul>
    </div>
  </div>

  <script>
    const ADMIN_PASSWORD = "s21i06a95";

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
    const loginCard = document.getElementById("login-card");
    const adminCard = document.getElementById("admin-card");
    const loginBtn = document.getElementById("login-btn");
    const logoutBtn = document.getElementById("logout-btn");
    const passwordInput = document.getElementById("password");
    const loginError = document.getElementById("login-error");

    // –¢–∞–±—ã
    const tabButtons = document.querySelectorAll(".tab-btn");
    
    // –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
    const searchRow = document.getElementById("search-row");
    const filtersRow = document.getElementById("filters-row");
    const searchInput = document.getElementById("search-input");
    const searchBtn = document.getElementById("search-btn");
    const filterGender = document.getElementById("filter-gender");
    const filterCity = document.getElementById("filter-city");
    const filterAgeMin = document.getElementById("filter-age-min");
    const filterAgeMax = document.getElementById("filter-age-max");

    // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
    const resultsInfo = document.getElementById("results-info");
    const usersList = document.getElementById("users-list");

    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    const statTotal = document.getElementById("stat-total");
    const statNew = document.getElementById("stat-new");
    const statActive = document.getElementById("stat-active");
    const statBlocked = document.getElementById("stat-blocked");

    // –ë–∞–Ω–Ω–µ—Ä—ã
    const sectionBanners = {
      all: document.getElementById("section-banner-all"),
      new: document.getElementById("section-banner-new"),
      blocked: document.getElementById("section-banner-blocked"),
      search: document.getElementById("section-banner-search")
    };

    // –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    let currentTab = "all";
    let allUsers = [];
    let filteredUsers = [];

    // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ)
    function generateDemoUsers(count = 50) {
      const cities = ["–ú–æ—Å–∫–≤–∞", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥", "–ö–∞–∑–∞–Ω—å", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥", "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä"];
      const names = {
        male: ["–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–î–º–∏—Ç—Ä–∏–π", "–ú–∞–∫—Å–∏–º", "–ê—Ä—Ç—ë–º", "–ò–≤–∞–Ω", "–ö–∏—Ä–∏–ª–ª", "–ú–∏—Ö–∞–∏–ª"],
        female: ["–ê–Ω–∞—Å—Ç–∞—Å–∏—è", "–ú–∞—Ä–∏—è", "–ê–Ω–Ω–∞", "–í–∏–∫—Ç–æ—Ä–∏—è", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞", "–ï–ª–µ–Ω–∞", "–û–ª—å–≥–∞"]
      };
      
      const users = [];
      const now = new Date();
      const dayMs = 24 * 60 * 60 * 1000;
      
      for (let i = 1; i <= count; i++) {
        const gender = Math.random() > 0.5 ? "male" : "female";
        const nameList = names[gender];
        const name = nameList[Math.floor(Math.random() * nameList.length)];
        
        // –°–ª—É—á–∞–π–Ω–∞—è –¥–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–æ—Ç 1 –¥–æ 30 –¥–Ω–µ–π –Ω–∞–∑–∞–¥)
        const daysAgo = Math.floor(Math.random() * 30);
        const registrationDate = new Date(now.getTime() - daysAgo * dayMs);
        
        // 10% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
        const blocked = Math.random() < 0.1;
        
        // 20% –Ω–æ–≤—ã—Ö (–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞)
        const isNew = daysAgo === 0;
        
        users.push({
          id: i,
          name: name,
          age: 18 + Math.floor(Math.random() * 30),
          gender: gender,
          username: `${name.toLowerCase()}_${i}`,
          city: cities[Math.floor(Math.random() * cities.length)],
          bio: "–õ—é–±–ª—é –∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è",
          registration_date: registrationDate.toISOString().split('T')[0],
          days_ago: daysAgo,
          blocked: blocked,
          is_new: isNew,
          last_active: new Date(now.getTime() - Math.floor(Math.random() * 7) * dayMs).toISOString()
        });
      }
      
      return users;
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    allUsers = generateDemoUsers(50);

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    function updateStats() {
      const total = allUsers.length;
      const newUsers = allUsers.filter(u => u.is_new).length;
      const blocked = allUsers.filter(u => u.blocked).length;
      const active = total - blocked;
      
      statTotal.textContent = total;
      statNew.textContent = newUsers;
      statActive.textContent = active;
      statBlocked.textContent = blocked;
    }

    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–µ
    function filterUsersByTab() {
      let filtered = [...allUsers];
      
      switch(currentTab) {
        case "all":
          // –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ ID (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
          filtered.sort((a, b) => b.id - a.id);
          break;
          
        case "new":
          // –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ (–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞)
          filtered = allUsers.filter(u => u.is_new);
          filtered.sort((a, b) => b.id - a.id);
          break;
          
        case "blocked":
          // –¢–æ–ª—å–∫–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
          filtered = allUsers.filter(u => u.blocked);
          filtered.sort((a, b) => b.id - a.id);
          break;
          
        case "search":
          // –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
          const searchTerm = searchInput.value.trim().toLowerCase();
          const genderFilter = filterGender.value;
          const cityFilter = filterCity.value;
          const ageMin = parseInt(filterAgeMin.value) || 18;
          const ageMax = parseInt(filterAgeMax.value) || 99;
          
          filtered = allUsers.filter(u => {
            // –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É
            const matchesSearch = !searchTerm || 
              String(u.id).includes(searchTerm) ||
              u.name.toLowerCase().includes(searchTerm) ||
              u.username.toLowerCase().includes(searchTerm) ||
              u.city.toLowerCase().includes(searchTerm);
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–ª—É
            const matchesGender = !genderFilter || u.gender === genderFilter;
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –≥–æ—Ä–æ–¥—É
            const matchesCity = !cityFilter || u.city === cityFilter;
            
            // –§–∏–ª—å—Ç—Ä –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É
            const matchesAge = u.age >= ageMin && u.age <= ageMax;
            
            return matchesSearch && matchesGender && matchesCity && matchesAge;
          });
          
          filtered.sort((a, b) => b.id - a.id);
          break;
      }
      
      filteredUsers = filtered;
      return filtered;
    }

    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    function renderUsers(users) {
      usersList.innerHTML = "";
      
      if (!users.length) {
        const emptyMsg = {
          "all": "–ù–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
          "new": "–ù–µ—Ç –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞",
          "blocked": "–ù–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
          "search": "–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
        }[currentTab];
        
        resultsInfo.textContent = emptyMsg;
        return;
      }
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
      const tabTitles = {
        "all": "–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
        "new": "–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
        "blocked": "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏",
        "search": "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞"
      };
      
      resultsInfo.textContent = `${tabTitles[currentTab]}: ${users.length} –∞–Ω–∫–µ—Ç`;
      
      // –†–µ–Ω–¥–µ—Ä–∏–º –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      users.forEach((u) => {
        const li = document.createElement("li");
        li.className = `user-item ${u.blocked ? 'blocked' : ''} ${u.is_new ? 'new' : ''}`;

        const main = document.createElement("div");
        main.className = "user-main";
        main.innerHTML = `
          <span class="user-name">${u.name}, ${u.age} –ª–µ—Ç</span>
          <div class="user-meta">
            <span>ID: ${u.id}</span>
            <span>@${u.username}</span>
            <span>${u.city}</span>
            <span>${u.gender === 'male' ? '‚ôÇ –ú—É–∂—Å–∫–æ–π' : '‚ôÄ –ñ–µ–Ω—Å–∫–∏–π'}</span>
            <span>–†–µ–≥.: ${u.registration_date}</span>
            ${u.blocked ? '<span style="color:var(--danger)">üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>' : ''}
            ${u.is_new ? '<span style="color:var(--info)">üÜï –ù–æ–≤—ã–π</span>' : ''}
          </div>
        `;

        const actions = document.createElement("div");
        actions.className = "user-actions";

        const openBtn = document.createElement("button");
        openBtn.className = "link-btn";
        openBtn.textContent = "–û—Ç–∫—Ä—ã—Ç—å –≤ TG";
        openBtn.onclick = () => {
          if (u.username) {
            window.open("https://t.me/" + u.username, "_blank");
          } else {
            alert("–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç username.");
          }
        };

        const blockBtn = document.createElement("button");
        blockBtn.className = u.blocked ? "unblock-btn" : "block-btn";
        blockBtn.textContent = u.blocked ? "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å" : "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å";
        blockBtn.onclick = () => {
          u.blocked = !u.blocked;
          u.is_new = false; // –°–Ω–∏–º–∞–µ–º —Å—Ç–∞—Ç—É—Å "–Ω–æ–≤—ã–π" –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ
          blockBtn.textContent = u.blocked ? "–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å" : "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å";
          blockBtn.className = u.blocked ? "unblock-btn" : "block-btn";
          li.classList.toggle('blocked', u.blocked);
          
          updateStats();
          filterUsersByTab();
          renderUsers(filteredUsers);
          
          alert(
            u.blocked
              ? "‚úÖ –ê–Ω–∫–µ—Ç–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (–¥–µ–º–æ-—Ä–µ–∂–∏–º)"
              : "‚úÖ –ê–Ω–∫–µ—Ç–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (–¥–µ–º–æ-—Ä–µ–∂–∏–º)"
          );
        };

        actions.appendChild(openBtn);
        actions.appendChild(blockBtn);

        li.appendChild(main);
        li.appendChild(actions);
        usersList.appendChild(li);
      });
    }

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
    function switchTab(tabName) {
      currentTab = tabName;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
      tabButtons.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.tab === tabName);
      });
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
      searchRow.classList.toggle('active', tabName === 'search');
      filtersRow.classList.toggle('active', tabName === 'search');
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä—ã
      Object.keys(sectionBanners).forEach(key => {
        sectionBanners[key].classList.toggle('hidden', key !== tabName);
      });
      
      // –§–∏–ª—å—Ç—Ä—É–µ–º –∏ —Ä–µ–Ω–¥–µ—Ä–∏–º
      const users = filterUsersByTab();
      renderUsers(users);
    }

    // –õ–æ–≥–∏–Ω
    loginBtn.onclick = () => {
      const value = passwordInput.value;
      if (value === ADMIN_PASSWORD) {
        loginError.textContent = "";
        loginCard.classList.add("hidden");
        adminCard.classList.remove("hidden");
        localStorage.setItem("siamatch_admin_logged_in", "1");
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
        updateStats();
        switchTab("all");
      } else {
        loginError.textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å.";
      }
    };

    passwordInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") loginBtn.click();
    });

    // –õ–æ–≥–∞—É—Ç
    logoutBtn.onclick = () => {
      localStorage.removeItem("siamatch_admin_logged_in");
      adminCard.classList.add("hidden");
      loginCard.classList.remove("hidden");
      passwordInput.value = "";
      currentTab = "all";
    };

    // –ü–æ–∏—Å–∫
    searchBtn.onclick = () => {
      switchTab("search");
    };

    searchInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") switchTab("search");
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    filterGender.addEventListener("change", () => switchTab("search"));
    filterCity.addEventListener("change", () => switchTab("search"));
    filterAgeMin.addEventListener("change", () => switchTab("search"));
    filterAgeMax.addEventListener("change", () => switchTab("search"));

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ç–∞–±–æ–≤
    tabButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        switchTab(btn.dataset.tab);
      });
    });

    // –ê–≤—Ç–æ-–ª–æ–≥–∏–Ω
    (function init() {
      if (localStorage.getItem("siamatch_admin_logged_in") === "1") {
        loginCard.classList.add("hidden");
        adminCard.classList.remove("hidden");
        updateStats();
        switchTab("all");
      }
    })();
  </script>
</body>
</html>
